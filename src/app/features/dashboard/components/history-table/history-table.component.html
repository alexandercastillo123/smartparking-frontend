<!-- History Table Component SmartParking -->
<div class="glass-card p-8 animate-fade-in overflow-hidden relative">
  <!-- Brillo decorativo superior -->
  <div class="absolute -top-12 -right-12 w-32 h-32 bg-blue-500/5 rounded-full blur-3xl"></div>

  <!-- Header -->
  <div class="flex items-center justify-between mb-6 relative z-10">
    <h3 class="text-xs font-black text-gray-400 uppercase tracking-[0.2em]">Actividad Reciente</h3>
  </div>

  <!-- Loading State -->
  @if (isLoading) {
  <div class="flex justify-center items-center py-12">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
  </div>
  }

  <!-- Tabla de historial -->
  @if (!isLoading) {
  <div class="overflow-x-auto relative z-10 custom-scrollbar">
    <table class="w-full text-left">
      <!-- Header de la tabla -->
      <thead>
        <tr class="border-b border-gray-100/50">
          <th class="py-4 px-4 text-[10px] font-black text-gray-400 uppercase tracking-widest">Espacio</th>
          <th class="py-4 px-4 text-[10px] font-black text-gray-400 uppercase tracking-widest">Fecha</th>
          <th class="py-4 px-4 text-[10px] font-black text-gray-400 uppercase tracking-widest">Inicio</th>
          <th class="py-4 px-4 text-[10px] font-black text-gray-400 uppercase tracking-widest">Estado</th>
        </tr>
      </thead>

      <!-- Cuerpo de la tabla -->
      <tbody class="divide-y divide-gray-50/50">
        @for (record of historyRecords; track record.reservationId) {
        <tr class="hover:bg-white/40 transition-colors duration-300 cursor-pointer group"
          (click)="onRecordClick(record)">
          <td class="py-5 px-4">
            <span class="text-sm font-black text-gray-800">#{{ record.spaceCode }}</span>
          </td>
          <td class="py-5 px-4 text-xs font-bold text-gray-500">
            {{ record.date | date:'mediumDate':'UTC' }}
          </td>
          <td class="py-5 px-4 text-xs font-bold text-gray-500">
            {{ record.startTime | date:'shortTime':'UTC' }}
          </td>
          <td class="py-5 px-4">
            <span [ngClass]="{
                  'bg-green-50 text-green-600': record.status === 'completed',
                  'bg-red-50 text-red-600': record.status === 'cancelled',
                  'bg-blue-50 text-blue-600': record.status === 'active'
                }"
              class="px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-tighter shadow-sm border border-white/50">
              {{ record.status }}
            </span>
          </td>
        </tr>
        }

        @if (historyRecords.length === 0) {
        <tr>
          <td colspan="4" class="py-12 text-center">
            <div class="flex flex-col items-center gap-3 opacity-30">
              <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <p class="text-xs font-black uppercase tracking-widest text-gray-500">Sin actividad previa</p>
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- Enlace "Ver historial completo" -->
  @if (showViewAllLink && historyRecords.length > 0) {
  <div class="mt-8 text-center relative z-10">
    <button (click)="onViewAllClick()"
      class="px-6 py-2.5 bg-white/50 border border-white/80 rounded-xl text-[10px] font-black uppercase tracking-widest text-gray-500 hover:bg-white hover:text-blue-600 transition-all duration-300 shadow-sm hover:shadow-md">
      Ver historial completo
    </button>
  </div>
  }
  }
</div>