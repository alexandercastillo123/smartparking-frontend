<!-- Navbar SmartParking -->
<nav
  class="sticky top-0 z-50 bg-white/30 backdrop-blur-md border-b border-white/20 px-4 md:px-6 py-4 min-h-16 shadow-sm">
  <div class="flex items-center justify-between max-w-7xl mx-auto">

    <!-- Logo y título (Izquierda) -->
    <div class="flex items-center space-x-3">
      <img src="assets/images/logo.png" alt="SmartParking Logo"
        class="w-10 h-10 transition-transform duration-300 hover:scale-110 drop-shadow-md">
      <h1 class="text-text-title font-bold text-xl font-sans">
        SmartParking
      </h1>
    </div>

    <!-- Navegación central -->
    <div class="hidden md:flex items-center space-x-8">
      <ng-container *ngIf="user_role | async as role">
        <a *ngFor="let item of navItems[role]" [routerLink]="item.route" routerLinkActive="text-blue-600 font-semibold"
          (click)="onNavClick(item.route)"
          class="text-gray-700 hover:text-blue-500 transition-colors duration-200 text-sm uppercase tracking-wider">
          {{ item.label }}
        </a>
      </ng-container>
    </div>

    <!-- Avatar del usuario (Derecha) -->
    <div class="flex items-center relative">
      <button class="focus:outline-none" (click)="toggleAvatarMenu($event)" aria-haspopup="true"
        [attr.aria-expanded]="isAvatarMenuOpen">
        <img src="assets/images/photo-profile-icon.png" alt="Perfil de usuario"
          class="w-10 h-10 rounded-full cursor-pointer hover:opacity-80 transition-opacity duration-200">
      </button>
      <div *ngIf="isAvatarMenuOpen"
        class="absolute top-full right-0 mt-2 w-40 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50"
        (click)="$event.stopPropagation()">
        <a (click)="logout()" class="block px-4 py-2 hover:bg-gray-100 cursor-pointer text-red-600">Logout</a>
      </div>

    </div>

    <!-- Menú hamburguesa para móvil -->
    <div class="md:hidden">
      <button (click)="toggleMobileMenu()"
        class="text-text-secondary hover:text-text-title transition-colors duration-200 p-2"
        aria-label="Menú de navegación" [attr.aria-expanded]="isMobileMenuOpen">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          @if (isMobileMenuOpen) {
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          } @else {
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          }
        </svg>
      </button>
    </div>

  </div>

  <!-- Menú móvil desplegable -->
  <div class="md:hidden transition-all duration-300 ease-in-out overflow-hidden" [class.max-h-0]="!isMobileMenuOpen"
    [class.max-h-96]="isMobileMenuOpen">
    <div class="pt-4 pb-4 border-t border-gray-200">
      <div class="flex flex-col space-y-3">
        <ng-container *ngIf="user_role | async as role">
          <a *ngFor="let item of navItems[role]" [routerLink]="item.route"
            (click)="onNavClick(item.route); closeMobileMenu()" class="hover:text-gray-300">
            {{ item.label }}
          </a>
        </ng-container>
      </div>
    </div>
  </div>
</nav>